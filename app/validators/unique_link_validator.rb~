class UniqueLinkValidator < ActiveModel::EachValidator
  def validate_each(record,attribute,value)
    if (record.send(options[:with]) <= Time.zone.now.beginning_of_day && !Deal.where(link:value).blank?)
        record.errors[attribute] << (options[:message] || "is not a unique link for an active deal")
    end
  end
end
